let Router,AccountManager,ValidateParams,Suspend;_393‍.x([["default",()=>_393‍.o]]);_393‍.w("express",[["Router",["Router"],function(v){Router=v}]]);_393‍.w("../../mongo/account",[["default",["AccountManager"],function(v){AccountManager=v}]]);_393‍.w("../utils/params",[["default",["ValidateParams"],function(v){ValidateParams=v}]]);_393‍.w("../../utils/suspend",[["default",["Suspend"],function(v){Suspend=v}]]);






const Login = Router();

Login.post('/auth/login', async (req, res) => {
    //await Suspend(1000);

    if (!ValidateParams(req, {
        username: 'string',
        password: 'string'
    })) return res.status(400).end();

    const user = req.body.username;
    const pwd = req.body.password;

    const authStatus = await AccountManager.authorize(
        user,
        pwd
    );

    if (authStatus === 200) {
        const token = AccountManager.generateToken(user);
        res.send('jwt', token);
    } else res.status(authStatus).end();
});

_393‍.d(Login);