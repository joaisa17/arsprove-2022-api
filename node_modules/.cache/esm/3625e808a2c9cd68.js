let Router,AccountManager,Suspend;_a2c‍.x([["default",()=>_a2c‍.o]]);_a2c‍.w("express",[["Router",["Router"],function(v){Router=v}]]);_a2c‍.w("../../mongo/account",[["default",["AccountManager"],function(v){AccountManager=v}]]);_a2c‍.w("../../utils/suspend",[["default",["Suspend"],function(v){Suspend=v}]]);





const Logout = Router();

Logout.post('/auth/logout', async (req, res) => {
    //await Suspend(1000);

    if (
        !req.user ||
        !req.headers.authorization ||
        !req.headers.authorization.match(/Bearer [^\s]+/)
    ) return res.status(401).end();

    const token = req.headers.authorization.split(/ /)[1];
    const expireStatus = await AccountManager.expireToken(token);

    res.status(expireStatus).end();
});

_a2c‍.d(Logout);